webpackJsonp([21],{BhtN:function(t,e){},ca5J:function(t,e){},tRpk:function(t,e,s){"use strict";var i=s("/kga"),a=(i.a,i.a,{name:"service-help",components:{XDialog:i.a},comments:{XDialog:i.a},data:function(){return{help:!0}},props:["showName"],methods:{close:function(){this.$parent[this.showName]=!1}}}),o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"service-help"}},[s("x-dialog",{staticClass:"service-help",model:{value:t.help,callback:function(e){t.help=e},expression:"help"}},[s("div",{staticClass:"title"},[t._v("图文咨询使用指南")]),t._v(" "),s("p",[t._v("提问规则")]),t._v(" "),s("p",[t._v("• 提问包含一次提问机会及两次免费追问机会。")]),t._v(" "),s("p",[t._v("• 购买服务后，请于72小时内向医生提问，医生将于首次提问后72小时内进行回复。")]),t._v(" "),s("br"),t._v(" "),s("p",[t._v("温馨提示")]),t._v(" "),s("p",[t._v("• 首次提问，系统开始计时。当医生对您的提问进行一次回复时，视为当前服务已完成，但您仍有两次免费追问机会，追问回复不包含在服务必须内容中；若医生在24小时内未回复您的首次提问，视为未完成服务，款项于5个工作日内原路退回。")]),t._v(" "),s("p",[t._v("• 请尽可能在首次提问详细地描述您的问题，提交完成后，耐心等待医生回答。")]),t._v(" "),s("p",[t._v("• 如有其它疑问，请致电：400-618-1318 联系客服，我们将在第一时间为您处理。")]),t._v(" "),s("div",{staticClass:"close",on:{click:t.close}},[s("svg-icon",{staticClass:"icon-close",attrs:{"icon-class":"record_h5_ icon_delete"}})],1)])],1)},staticRenderFns:[]};var n=s("VU/8")(a,o,!1,function(t){s("ca5J")},null,null);e.a=n.exports},"uH+L":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),o=s("rHil"),n=s("1DHf"),r=s("32ER"),l=s("HD9R"),c=s("63CM"),d=s("Z8XE"),u=s("gyMJ"),v=s("tRpk"),p=(s("8kUR"),s("un6a"),s("aQR8")),h=s("mHYM"),_=(o.a,n.a,l.a,r.a,v.a,d.a,c.a,{name:"problem-detail",components:{Group:o.a,Cell:n.a,Popup:l.a,CellBox:r.a,serviceHelp:v.a,XProgress:d.a},data:function(){return{showPopup:!0,help:!1,showImg:!1,showImgUrl:"",advisoriesId:"",advisories:{},audioPercent:[],audioIndex:0,paused:!0,audioTime:[],setInterval:null,audio:["https://sleep-doctor-dev.oss-cn-shenzhen.aliyuncs.com/cbti/relaxation/88f63f53-f1b9-4897-b28a-aa59860049a5.mp3","https://sleep-doctor-dev.oss-cn-shenzhen.aliyuncs.com/cbti/relaxation/86d98af0-2908-42c8-a2d0-0678d2c25c35.mp3"]}},methods:{parentClick:function(t,e){e===this.audioIndex&&this.$set(this.audioPercent,this.audioIndex,Object(h.g)(t.offsetX,t.target.clientWidth))},mousedownChild:function(t){console.log("子元素")},play:function(t){var e=this;null!==this.setInterval&&clearInterval(this.setInterval),this.setInterval=setInterval(function(){console.log("11   asdfsadfasdf asdf sadf sad",e.audioIndex);var s=Object(h.g)(t.target.currentTime,t.target.duration);s>=100&&(e.paused=!0,clearInterval(e.setInterval)),e.$set(e.audioPercent,e.audioIndex,s),e.$set(e.audioTime,e.audioIndex,e.currentTime(t.target.currentTime))},30)},toDetail:function(t){if(1===t.length){var e={page:"onlineReport",payload:{id:t[0].id}};this.$router.push({name:"native-route",query:{data:a()(e)}})}else this.$router.push({path:"/mine/report"})},audioBtn:function(t){this.paused?(this.$refs["audio"+t][0].play(),this.audioIndex=t,this.paused=!1):t===this.audioIndex?(this.$refs["audio"+this.audioIndex][0].pause(),null!==this.setInterval&&clearInterval(this.setInterval),this.paused=!0):(this.$refs["audio"+this.audioIndex][0].pause(),this.$refs["audio"+t][0].play(),this.audioIndex=t)},currentTime:function(t){var e=0|t;return(e/60|0)+":"+this._pad(e%60)},_pad:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=t.toString().length;s<e;)t="0"+t,s++;return t},loadedmetadata:function(t){var e=this;this.$nextTick(function(){e.audioPercent.push(0),e.audioTime.push(e.currentTime(t.target.duration))})},mousemoveChild:function(t,e){null!==this.setInterval&&clearInterval(this.setInterval);var s=void 0;s=t.touches?t.touches[0]:t;var i=t.target.parentElement,a=i.offsetLeft,o=i.clientWidth,n=s.clientX-a,r=Object(h.g)(n,o);r>=100?r=100:r<=0&&(r=0),e===this.audioIndex&&this.$set(this.audioPercent,this.audioIndex,r)},touchend:function(t,e){var s=this,i=t,a=t.target.parentElement.clientWidth,o=i.target.offsetLeft,n=Object(h.g)(o,a);if(n>=100?n=100:n<=0&&(n=0),e===this.audioIndex&&!this.paused){var r=this.$refs["audio"+this.audioIndex][0];r.currentTime=n*r.duration/100,null!==this.setInterval&&clearInterval(this.setInterval),this.setInterval=setInterval(function(){var t=Object(h.g)(r.currentTime,r.duration);t>=100&&(s.$set(s.audioPercent,s.audioIndex,0),s.paused=!0,clearInterval(s.setInterval)),s.$set(s.audioPercent,s.audioIndex,t),s.$set(s.audioTime,s.audioIndex,s.currentTime(r.currentTime))},30)}},getAdvisories:function(){var t=this;return u.a.get("/advisories/"+this.advisoriesId+"/",{params:{include:"user,doctor,records"}}).then(function(e){return t.advisories=e.data,t.advisories.records.map(function(e,s){if(e.question_index_text=p.d[e.question_index],e.created_at=t.$moment.unix(e.created_at).format("YYYY.MM.DD HH:mm"),e.reportsShow=[],e.content=e.content.replace(/\n/g,"<br>"),e.reports&&e.reports.length>0)for(var i=0;i<e.reports.length;i++)e.reportsShow.push(e.reports[i].id);1===e.content_type&&t.$set(t.audioTime,s,t.currentTime(e.sound.duration))}),e.data})},showImgClick:function(t){console.log(t),this.showImg=!0,this.showImgUrl=t}},created:function(){this.advisoriesId=this.$route.params.id,this.getAdvisories()},directives:{TransferDom:c.a}}),m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"problem-detail"}},[4===t.advisories.status&&0===t.advisories.start_at?s("div",{staticClass:"no-data"},[s("div",{staticClass:"banner"},[t._v("服务已取消")]),t._v(" "),s("svg-icon",{staticClass:"no-data-icon",attrs:{"icon-class":"emptystate_img_cancellation"}}),t._v(" "),s("p",{staticClass:"title"},[t._v("相关服务已取消")]),t._v(" "),s("p",{staticClass:"decs"},[t._v("如有疑问，请咨询客服")])],1):s("div",[s("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[s("popup",{attrs:{position:"top","show-mask":!1},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[s("div",{staticClass:"position-vertical",class:{yellow:2===t.advisories.status||3===t.advisories.status||4===t.advisories.status}},[t._v("\n          "+t._s(t.advisories.remind_description)+"\n        ")])]),t._v(" "),t.showImg?s("div",{staticClass:"weui-gallery",staticStyle:{height:"100%",width:"100%",display:"block"}},[s("span",{staticClass:"weui-gallery__img",style:{backgroundImage:"url("+t.showImgUrl+")"},on:{click:function(e){t.showImg=!t.showImg}}})]):t._e(),t._v(" "),s("transition",{attrs:{name:"help"}},[t.help?s("service-help",{attrs:{showName:"help"}}):t._e()],1)],1),t._v(" "),s("div",{staticClass:"help",class:{mgtop:t.showPopup}},[t._v("\n      如对咨询有疑问，可查看"),s("span",{on:{click:function(e){t.help=!t.help}}},[t._v("图文咨询使用指南")])]),t._v(" "),t._l(t.advisories.records,function(e,i){return t.advisories?s("div",{key:e.name,staticClass:"problem-lists"},[0===e.type?s("group",[s("cell",[s("div",{staticClass:"cell-title",attrs:{slot:"title"},slot:"title"},[t._v("\n            第"+t._s(e.question_index_text)+"次提问\n          ")]),t._v(" "),s("div",{staticClass:"time"},[t._v("\n            "+t._s(e.created_at)+"\n          ")])]),t._v(" "),s("cell-box",{staticStyle:{height:"auto"}},[s("div",{staticStyle:{width:"100%"}},[s("p",{staticClass:"problem-text",domProps:{innerHTML:t._s(e.content)}}),t._v(" "),s("div",{staticClass:"weui-uploader"},[s("div",{staticClass:"weui-uploader__bd"},[s("ul",{staticClass:"weui-uploader__files"},t._l(e.images,function(e){return s("li",{key:e,staticClass:"weui-uploader__file",style:{backgroundImage:"url("+e+")"},on:{click:function(s){t.showImgClick(e)}}})}))])])])]),t._v(" "),0!==e.reports.length?s("cell",{attrs:{"is-link":""},nativeOn:{click:function(s){t.toDetail(e.reports)}}},[s("div",{staticClass:"cell-title",attrs:{slot:"title"},slot:"title"},[t._v("\n            查看电子报告\n          ")])]):t._e()],1):t._e(),t._v(" "),1===e.type?s("group",[s("cell",[s("div",{staticClass:"cell-title doctor",attrs:{slot:"title"},slot:"title"},[s("img",{attrs:{src:t.advisories.doctor.avatar,alt:""}}),t._v("\n            "+t._s(t.advisories.doctor.name)+"\n          ")]),t._v(" "),s("div",{staticClass:"time"},[t._v("\n            "+t._s(e.created_at)+"\n          ")])]),t._v(" "),0===e.content_type?s("cell-box",{staticStyle:{height:"auto"}},[s("div",[s("p",{staticClass:"problem-text",domProps:{innerHTML:t._s(e.content)}})])]):s("cell-box",{staticClass:"audio"},[s("div",{staticClass:"audio-setting"},[s("svg-icon",{staticClass:"audio-btn",attrs:{"icon-class":t.audioIndex!==i||t.paused?"graphic_icon_play":"graphic_icon_pause"},nativeOn:{click:function(e){t.audioBtn(i)}}}),t._v(" "),s("div",{staticClass:"audio-progress",on:{mousedown:function(e){t.parentClick(e,i)}}},[s("x-progress",{attrs:{"show-cancel":!1,percent:t.audioPercent[i]}}),t._v(" "),s("div",{staticClass:"progress-btn",style:{left:t.audioPercent[i]+"%"},on:{mousedown:function(e){e.stopPropagation(),t.mousedownChild(e,i)},touchmove:function(e){e.stopPropagation(),t.mousemoveChild(e,i)},touchend:function(e){e.stopPropagation(),t.touchend(e,i)}}})],1)],1),t._v(" "),s("div",{staticClass:"audio-time"},[t._v("\n            "+t._s(t.audioTime[i])+"\n          ")]),t._v(" "),s("audio",{ref:"audio"+i,refInFor:!0,staticStyle:{"max-width":"0","max-height":"0",float:"left",display:"none"},attrs:{controls:"controls",src:e.sound.url},on:{play:t.play,loadedmetadata:function(e){t.loadedmetadata(e,i)}}})])],1):t._e()],1):t._e()})],2),t._v(" "),2!==t.advisories.status&&3!==t.advisories.status&&4!==t.advisories.status&&t.advisories.last_count>0?s("router-link",{staticClass:"inquiries",attrs:{to:{path:"/sketch-advice/matter-filling/"+t.advisories.id}}},[t._v("\n    追问（剩余"+t._s(t.advisories.last_count)+"次机会）\n  ")]):s("router-link",{staticClass:"inquiries",attrs:{to:{path:"/my-doctor"}}},[t._v("继续咨询")])],1)},staticRenderFns:[]};var f=s("VU/8")(_,m,!1,function(t){s("BhtN")},null,null);e.default=f.exports}});