webpackJsonp([12],{UIMx:function(t,o,e){"use strict";var i=e("piuB"),s=(i.b,String,{mounted:function(){},name:"tabbar",mixins:[i.b],props:{iconClass:String}}),n={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"weui-tabbar"},[this._t("default")],2)},staticRenderFns:[]};var r=e("VU/8")(s,n,!1,function(t){e("dVH7")},null,null);o.a=r.exports},XDR5:function(t,o){},ar3x:function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=e("Dd8w"),s=e.n(i),n=e("lRwf"),r=e.n(n),a=e("UIMx"),c=e("dgEa"),d=e("63CM"),l=e("HD9R"),u=e("Y52p"),h=e("2sLL"),m=e("NYxO"),p=e("gyMJ"),v=e("mHYM"),b=e("2CHa"),f=e("o0rJ"),_=e("Xe5u"),g=e("SpbH"),x=e.n(g),$=(Object(m.b)({profile:function(t){return t.user.profile}}),d.a,a.a,c.a,l.a,u.a,h.a,{computed:Object(m.b)({profile:function(t){return t.user.profile}}),directives:{TransferDom:d.a},components:{Tabbar:a.a,TabbarItem:c.a,Popup:l.a,XImg:u.a,XButton:h.a},data:function(){return{bindLabel:"绑定为我的主治医生",isBind:!1,isGoHome:!0,doctorId:"",showPopup:!1,doctorInfo:{avatar:"#"},downArrow:x.a,showDetailBtn:!1,showAll:!1}},watch:{showPopup:function(t){var o=this;t&&setTimeout(function(){o.showPopup=!1,o.$router.push({path:"/my-doctor"})},2e3)}},methods:{getDoctorInfo:function(t){var o=this;console.log(t),p.a.get("doctors/"+t,{params:{include:"services"}}).then(function(t){o.doctorInfo=t.data,r.a.nextTick(function(){o.$refs.doc_des.getBoundingClientRect().height>120&&(o.showDetailBtn=!0)})}).catch(function(t){404===t.status_code?o.$vux.toast.text("该二维码已失效","bottom"):o.$vux.toast.text(t.message,"bottom")})},showDetail:function(){this.showAll=!0},tryBindDoctor:function(t){var o=this;this.profile.doctor?this.profile.doctor.id===parseInt(this.$route.params.id)?2===Object(v.a)()?Object(f.a)(function(t){t.callHandler("bindDoctorResult",{code:0,message:"已绑定过该医生",result:o.profile.doctor})}):this.$router.push("/my-doctor"):this.$vux.toast.text("您已绑定了其他医生","bottom"):this.bindDoctor(t)},bindDoctor:function(t){var o=this,e={doctor_id:Number(t)};this.$route.query.openid&&(e.open_id=this.$route.query.openid,e.union_id=this.$route.query.unionid),console.log(t,"bindDoctor"),p.a.patch("doctor-bind",e).then(function(e){var i=e.data;if(i.error)1===i.error.code?o.$vux.toast.text(i.error.user_message,"bottom"):o.$router.push("/my-doctor?doctorId="+t);else{if(2===Object(v.a)())return void Object(f.a)(function(t){t.callHandler("bindDoctorResult",{code:0,message:"绑定成功",result:e.data})});var n=s()({},o.profile);n.doctor=e.data,o.$store.commit("SET_PROFILE",n),o.$vux.toast.text("绑定成功","bottom"),o.$router.push("/my-doctor?doctorId="+t)}}).catch(function(e){403===e.code?(o.isBind=!0,o.$vux.toast.text(e.message,"bottom")):404===e.status_code?o.$vux.toast.text("该二维码已失效","bottom"):2===e.error.code?(o.$vux.toast.text(e.error.internal_message,"bottom"),o.$router.push("/my-doctor?doctorId="+t)):1===e.error.code?(o.$vux.toast.text(e.error.internal_message,"bottom"),console.log("微信未授权")):o.$vux.toast.text(e.message,"bottom")})},goBackHome:function(){this.$router.push("/")}},created:function(){var t=this,o=this.$route.query;if(console.log(o.token,"to.token,"),o.token&&(Object(b.c)(o.token),this.$store.commit("SET_TOKEN",o.token)),this.doctorId=this.$route.params.id,2===Object(v.a)()&&(this.isGoHome=!1),console.log(Object(b.a)(),"getToken()"),Object(b.a)()||o.token)this.getDoctorInfo(this.doctorId),this.$store.dispatch("GetUserProfile").then(function(){t.profile.doctor&&t.profile.doctor.id===parseInt(t.$route.params.id)&&(2===Object(v.a)()?Object(f.a)(function(o){o.callHandler("bindDoctorResult",{code:0,message:"已绑定过该医生",result:t.profile.doctor})}):t.$router.push("/my-doctor"))});else{if(!o.openid&&2!==Object(v.a)()){var e=window.location.origin+"/doctor/"+this.doctorId+"?from="+encodeURIComponent(o.fullPath);Object(_.e)(e)}this.getDoctorInfo(this.doctorId)}}}),w={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[t.profile?e("div",{staticStyle:{"background-color":"#F2F3F5"}},[e("div",[e("section",[e("div",{staticClass:"header bg_color_white"},[e("div",{staticClass:"box_shadow"},[e("img",{staticClass:"header_img",attrs:{src:t.doctorInfo.avatar}})]),t._v(" "),e("div",{staticClass:"header_right"},[e("h4",{staticClass:"intro_name"},[t._v(t._s(t.doctorInfo.name))]),t._v(" "),e("span",{},[t._v(t._s(t.doctorInfo.hospital)+"  "+t._s(t.doctorInfo.department))])])])])]),t._v(" "),t._m(0),t._v(" "),e("div",{staticClass:"bg_color_white"},[e("div",{ref:"doc_des",class:!t.showAll&&t.showDetailBtn?"desc":"description"},[e("p",{domProps:{innerHTML:t._s(t.doctorInfo.introduction)}}),t._v(" "),t.showDetailBtn&&!t.showAll?e("div",{staticClass:"detail",on:{click:t.showDetail}},[t._v("详细信息"),e("x-img",{attrs:{src:t.downArrow}})],1):t._e()])]),t._v(" "),e("div",{staticClass:"btn_wrapper"},[e("XButton",{staticClass:"bind_btn",attrs:{disabled:t.isBind},nativeOn:{click:function(o){t.tryBindDoctor(t.doctorId)}}},[t._v(t._s(t.bindLabel))])],1),t._v(" "),t.isGoHome?e("div",{staticClass:"go_back_home",on:{click:t.goBackHome}},[t._m(1)]):t._e()]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,o=this._self._c||t;return o("div",{staticClass:"bg_color_white"},[o("div",{staticClass:"title"},[o("span",[this._v("医生简介")])])])},function(){var t=this.$createElement,o=this._self._c||t;return o("span",[o("u",[this._v("回到首页")])])}]};var I=e("VU/8")($,w,!1,function(t){e("XDR5")},"data-v-7f9dec66",null);o.default=I.exports},dVH7:function(t,o){},dgEa:function(t,o,e){"use strict";var i=e("piuB"),s=(String,Number,{name:"badge",props:{text:[String,Number]}}),n={render:function(){var t=this.$createElement;return(this._self._c||t)("span",{class:["vux-badge",{"vux-badge-dot":void 0===this.text,"vux-badge-single":void 0!==this.text&&1===this.text.toString().length}],domProps:{textContent:this._s(this.text)}})},staticRenderFns:[]};var r=e("VU/8")(s,n,!1,function(t){e("kgee")},null,null).exports,a=(i.a,Boolean,String,String,Object,String,{name:"tabbar-item",components:{Badge:r},mounted:function(){this.$slots.icon||(this.simple=!0),this.$slots["icon-active"]&&(this.hasActiveIcon=!0)},mixins:[i.a],props:{showDot:{type:Boolean,default:!1},badge:String,link:[String,Object],iconClass:String},computed:{isActive:function(){return this.$parent.index===this.currentIndex}},data:function(){return{simple:!1,hasActiveIcon:!1}}}),c={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("a",{staticClass:"weui-tabbar__item",class:{"weui-bar__item_on":t.isActive,"vux-tabbar-simple":t.simple},attrs:{href:"javascript:;"},on:{click:function(o){t.onItemClick(!0)}}},[t.simple?t._e():e("div",{staticClass:"weui-tabbar__icon",class:[t.iconClass||t.$parent.iconClass,{"vux-reddot":t.showDot}]},[t.simple||t.hasActiveIcon&&t.isActive?t._e():t._t("icon"),t._v(" "),!t.simple&&t.hasActiveIcon&&t.isActive?t._t("icon-active"):t._e(),t._v(" "),t.badge?e("sup",[e("badge",{attrs:{text:t.badge}})],1):t._e()],2),t._v(" "),e("p",{staticClass:"weui-tabbar__label"},[t._t("label")],2)])},staticRenderFns:[]},d=e("VU/8")(a,c,!1,null,null,null);o.a=d.exports},kgee:function(t,o){}});