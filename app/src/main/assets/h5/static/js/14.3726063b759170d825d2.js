webpackJsonp([14],{"2OJK":function(e,t){},"3Xy8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Dd8w"),a=i.n(n),s=i("rHil"),c=i("1DHf"),o=i("63CM"),r=i("odqc"),l=i("Znkm"),d=i("NYxO"),u=i("32ER"),h=i("Msp2"),m=i("/kga"),f=(i("8kUR"),i("un6a"),i("aQR8")),p=i("gyMJ"),v=(s.a,c.a,u.a,h.a,m.a,o.a,{name:"medical-record",components:{Group:s.a,Cell:c.a,CellBox:u.a,Actionsheet:h.a,XDialog:m.a},data:function(){return{deleteAlert:!1,page:1,per_page:15,ingIndex:null,menus:{menu1:{label:"修改",value:"modify"},menu2:{label:"删除",type:"warn",value:"delete"}},showMenu:!1,contentHeight:0,images:["https://sleep-doctor-dev.oss-cn-shenzhen.aliyuncs.com/advisory/2096/2018-06-25/00c79e5c-addc-4eab-b1b7-eabdae35de87.jpg","https://sleep-doctor-dev.oss-cn-shenzhen.aliyuncs.com/advisory/2096/2018-06-25/00c79e5c-addc-4eab-b1b7-eabdae35de87.jpg","https://sleep-doctor-dev.oss-cn-shenzhen.aliyuncs.com/advisory/2096/2018-06-25/00c79e5c-addc-4eab-b1b7-eabdae35de87.jpg","https://sleep-doctor-dev.oss-cn-shenzhen.aliyuncs.com/advisory/2096/2018-06-25/00c79e5c-addc-4eab-b1b7-eabdae35de87.jpg","https://sleep-doctor-dev.oss-cn-shenzhen.aliyuncs.com/advisory/2096/2018-06-25/00c79e5c-addc-4eab-b1b7-eabdae35de87.jpg"],processData:[],showImgUrl:null}},methods:{treatedTime:function(e){return this.$moment.unix(this.processData[e].diagnosis_time).format("YYYY.MM.DD")},refresh:function(e){this.per_page=15,this.getData().then(function(t){e(!0)})},infinite:function(e){this.per_page+=15,this.getData().then(function(t){e(!0)})},more:function(e){this.ingIndex=e,this.showMenu=!0},menusClick:function(e){if("modify"===e){var t=this.processData[this.ingIndex];this.$router.push({path:"/mine/medical/add-record",query:t})}else"delete"===e&&(this.deleteAlert=!0)},delete1:function(){var e=this;return p.a.delete("medical-process/"+this.processData[this.ingIndex].id).then(function(){e.deleteAlert=!1,e.processData.splice(e.ingIndex,1)})},getData:function(){var e=this,t={params:{per_page:this.per_page,page:this.page}};return p.a.get("/medical-process",t).then(function(t){e.processData=t.data.data}).catch(function(e){console.log(e)})}},created:function(){},directives:{TransferDom:o.a},mounted:function(){this.contentHeight=f.c.height-44}}),_={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"medical-record"},[0===e.processData.length?i("div",{staticClass:"no-data",style:{height:e.contentHeight+"px",top:"44px"}},[i("svg-icon",{staticClass:"no-data-icon",attrs:{"icon-class":"emptystate_img_report"}}),e._v(" "),i("p",{staticClass:"title"},[e._v("暂无病历")]),e._v(" "),i("p",{staticClass:"decs"},[e._v("完善就诊信息，科学管理病程记录")])],1):e._e(),e._v(" "),i("scroller",{staticStyle:{width:"100%"},style:{height:e.contentHeight+"px",top:"44px"},attrs:{"on-refresh":e.refresh,"on-infinite":e.infinite,noDataText:""}},[i("div",e._l(e.processData,function(t,n){return i("group",{key:t.name},[i("cell",{attrs:{title:e.treatedTime(n)}},[i("div",{on:{click:function(t){e.more(n)}}},[i("svg-icon",{staticClass:"icon_svg",attrs:{"icon-class":"info_icon_more"}})],1)]),e._v(" "),i("cell-box",[i("div",{staticClass:"symptom"},e._l(t.symptoms,function(t){return i("span",{key:t.name},[e._v(e._s(t))])})),e._v(" "),i("div",{staticClass:"describe"},[e._v("\n            "+e._s(t.detail)+"\n          ")]),e._v(" "),i("div",{staticClass:"weui-uploader"},[i("div",{staticClass:"weui-uploader__bd"},[i("ul",{staticClass:"weui-uploader__files"},e._l(t.picture_urls,function(t){return i("li",{key:t,staticClass:"weui-uploader__file",style:{backgroundImage:"url("+t+")"},on:{click:function(i){e.showImgUrl=t}}})}))])])])],1)}))]),e._v(" "),e.showImgUrl?i("div",{staticClass:"weui-gallery",staticStyle:{height:"100%",width:"100%",display:"block"}},[i("span",{staticClass:"weui-gallery__img",style:{backgroundImage:"url("+e.showImgUrl+")"},on:{click:function(t){e.showImgUrl=null}}})]):e._e(),e._v(" "),i("router-link",{staticClass:"add-record",staticStyle:{display:"block"},attrs:{to:"/mine/medical/add-record"}},[e._v("\n    添加病程记录\n  ")]),e._v(" "),i("actionsheet",{attrs:{menus:e.menus,"show-cancel":""},on:{"on-click-menu":e.menusClick},model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}}),e._v(" "),i("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[i("x-dialog",{staticClass:"dialog-delete",attrs:{"hide-on-blur":""},model:{value:e.deleteAlert,callback:function(t){e.deleteAlert=t},expression:"deleteAlert"}},[i("P",{staticClass:"title"},[e._v("删除病程")]),e._v(" "),i("p",{staticClass:"describe"},[e._v("确定要删除此段病程记录吗？")]),e._v(" "),i("div",{staticClass:"dialog-ft"},[i("div",{staticClass:"cancel",on:{click:function(t){e.deleteAlert=!1}}},[e._v("取消")]),e._v(" "),i("div",{staticClass:"submit",on:{click:e.delete1}},[e._v("确定")])])],1)],1)],1)},staticRenderFns:[]};var g=i("VU/8")(v,_,!1,function(e){i("C58L")},null,null).exports,w=(s.a,c.a,u.a,a()({},Object(d.b)({profile:function(e){return e.user.profile}}),{geneticRecord:function(){return this.joinTextArrayWithPlaceHolder(this.medicalRecord.inheritance,"未填写")},allergicRecord:function(){return this.joinTextArrayWithPlaceHolder(this.medicalRecord.allergy,"未填写")},operatingRecord:function(){return this.joinTextArrayWithPlaceHolder(this.medicalRecord.surgery,"未填写")}}),{name:"medical-history",components:{Group:s.a,Cell:c.a,CellBox:u.a},computed:a()({},Object(d.b)({profile:function(e){return e.user.profile}}),{geneticRecord:function(){return this.joinTextArrayWithPlaceHolder(this.medicalRecord.inheritance,"未填写")},allergicRecord:function(){return this.joinTextArrayWithPlaceHolder(this.medicalRecord.allergy,"未填写")},operatingRecord:function(){return this.joinTextArrayWithPlaceHolder(this.medicalRecord.surgery,"未填写")}}),data:function(){return{medicalRecord:{allergy:[],inheritance:[],surgery:[]}}},created:function(){this.fetchMedicalRecord()},methods:{fetchMedicalRecord:function(){var e=this;console.log("fetchMedicalRecord"),p.a.get("/medical-record").then(function(t){console.log(t),t.data.error?(e.medicalRecord.allergy=[],e.medicalRecord.inheritance=[],e.medicalRecord.surgery=[]):e.medicalRecord=t.data}).catch(function(e){console.log(e.error.internal_message)})},joinTextArrayWithPlaceHolder:function(e,t){return e&&0!==e.length?"":t}}}),y={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"medical-history"},[i("group",{staticClass:"text-ovflow"},[i("cell",{attrs:{title:"过敏史",value:e.allergicRecord,"is-link":"",link:{path:"/mine/medical/item-input/allergy"}}}),e._v(" "),0!==e.medicalRecord.allergy.length?i("cell-box",{staticClass:"selects"},e._l(e.medicalRecord.allergy,function(t){return i("span",{key:t.name},[e._v(e._s(t))])})):e._e()],1),e._v(" "),i("group",{staticClass:"text-ovflow"},[i("cell",{attrs:{title:"手术或外伤",value:e.operatingRecord,"is-link":"",link:{path:"/mine/medical/item-input/surgery"}}}),e._v(" "),0!==e.medicalRecord.surgery.length?i("cell-box",{staticClass:"selects"},e._l(e.medicalRecord.surgery,function(t){return i("span",{key:t.name},[e._v(e._s(t))])})):e._e()],1),e._v(" "),i("group",{staticClass:"text-ovflow"},[i("cell",{attrs:{title:"家族遗传病史",value:e.geneticRecord,"is-link":"",link:{path:"/mine/medical/item-input/inheritance"}}}),e._v(" "),0!==e.medicalRecord.inheritance.length?i("cell-box",{staticClass:"selects"},e._l(e.medicalRecord.inheritance,function(t){return i("span",{key:t.name},[e._v(e._s(t))])})):e._e()],1)],1)},staticRenderFns:[]};var b=i("VU/8")(w,y,!1,function(e){i("2OJK")},null,null).exports,x=(s.a,c.a,r.a,l.a,o.a,a()({},Object(d.b)({profile:function(e){return e.user.profile},medical:function(e){return e.medical}})),{components:{Group:s.a,Cell:c.a,Tab:r.a,TabItem:l.a,record:g,history:b},directives:{TransferDom:o.a},data:function(){return{swiperIndex:0}},computed:a()({},Object(d.b)({profile:function(e){return e.user.profile},medical:function(e){return e.medical}})),watch:{swiperIndex:function(e){this.$store.dispatch("setSwiperindex",e)}},methods:{joinTextArrayWithPlaceHolder:function(e,t){return e&&0!==e.length?e.join(","):t}},created:function(){this.swiperIndex=this.medical.swiperIndex}}),C={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"profile-page1"},[i("tab",{ref:"tab",staticClass:"tab-fx",attrs:{"line-width":2,"custom-bar-width":"100px","active-color":"#6595F4"},model:{value:e.swiperIndex,callback:function(t){e.swiperIndex=t},expression:"swiperIndex"}},[i("tab-item",{staticClass:"vux-center"},[e._v("病历")]),e._v(" "),i("tab-item",{staticClass:"vux-center"},[e._v("病史")])],1),e._v(" "),i("keep-alive",[0===e.swiperIndex?i("record"):e._e()],1),e._v(" "),i("keep-alive",[1===e.swiperIndex?i("history"):e._e()],1)],1)},staticRenderFns:[]};var k=i("VU/8")(x,C,!1,function(e){i("M2X3")},null,null);t.default=k.exports},C58L:function(e,t){},M2X3:function(e,t){},Msp2:function(e,t,i){"use strict";var n=i("mvHQ"),a=i.n(n),s=i("pFYg"),c=i.n(s),o=(Boolean,Boolean,String,String,Object,Array,Boolean,Boolean,{name:"actionsheet",mounted:function(){var e=this;this.hasHeaderSlot=!!this.$slots.header,this.$nextTick(function(){e.$tabbar=document.querySelector(".weui-tabbar"),e.$refs.iOSMenu&&e.$refs.iOSMenu.addEventListener("transitionend",e.onTransitionEnd)})},props:{value:Boolean,showCancel:Boolean,cancelText:String,theme:{type:String,default:"ios"},menus:{type:[Object,Array],default:function(){return{}}},closeOnClickingMask:{type:Boolean,default:!0},closeOnClickingMenu:{type:Boolean,default:!0}},data:function(){return{hasHeaderSlot:!1,show:!1}},methods:{onTransitionEnd:function(){this.$emit(this.show?"on-after-show":"on-after-hide")},onMenuClick:function(e,t){"string"==typeof e?this.emitEvent("on-click-menu",t,e):"disabled"!==e.type&&"info"!==e.type&&(e.value||0===e.value?this.emitEvent("on-click-menu",e.value,e):(this.emitEvent("on-click-menu","",e),this.show=!1))},onClickingMask:function(){this.$emit("on-click-mask"),this.closeOnClickingMask&&(this.show=!1)},emitEvent:function(e,t,i){if("on-click-menu"===e&&!/.noop/.test(t)){var n=i;"object"===(void 0===n?"undefined":c()(n))&&(n=JSON.parse(a()(n))),this.$emit(e,t,n),this.$emit(e+"-"+t),this.closeOnClickingMenu&&(this.show=!1)}},fixIos:function(e){this.$el.parentNode&&-1!==this.$el.parentNode.className.indexOf("v-transfer-dom")||this.$tabbar&&/iphone/i.test(navigator.userAgent)&&(this.$tabbar.style.zIndex=e)}},watch:{show:function(e){var t=this;this.$emit("input",e),e?this.fixIos(-1):setTimeout(function(){t.fixIos(100)},200)},value:{handler:function(e){this.show=e},immediate:!0}},beforeDestroy:function(){this.fixIos(100),this.$refs.iOSMenu&&this.$refs.iOSMenu.removeEventListener("transitionend",this.onTransitionEnd)}}),r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vux-actionsheet"},[i("transition",{attrs:{name:"vux-actionsheet-mask"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"weui-mask weui-mask_transparent",on:{click:e.onClickingMask}})]),e._v(" "),"android"===e.theme?i("div",{staticClass:"weui-skin_android"},[i("transition",{attrs:{name:"vux-android-actionsheet"},on:{"after-enter":function(t){e.$emit("on-after-show")},"after-leave":function(t){e.$emit("on-after-hide")}}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"weui-actionsheet"},[i("div",{staticClass:"weui-actionsheet__menu"},e._l(e.menus,function(t,n){return i("div",{staticClass:"weui-actionsheet__cell",domProps:{innerHTML:e._s(t.label||t)},on:{click:function(i){e.onMenuClick(t,n)}}})}))])])],1):i("div",{ref:"iOSMenu",staticClass:"weui-actionsheet",class:{"weui-actionsheet_toggle":e.show}},[i("div",{staticClass:"weui-actionsheet__menu"},[e.hasHeaderSlot?i("div",{staticClass:"weui-actionsheet__cell"},[e._t("header")],2):e._e(),e._v(" "),e._l(e.menus,function(t,n){return i("div",{staticClass:"weui-actionsheet__cell",class:"vux-actionsheet-menu-"+(t.type||"default"),domProps:{innerHTML:e._s(t.label||t)},on:{click:function(i){e.onMenuClick(t,n)}}})})],2),e._v(" "),e.showCancel?i("div",{staticClass:"weui-actionsheet__action",on:{click:function(t){e.emitEvent("on-click-menu","cancel")}}},[i("div",{staticClass:"weui-actionsheet__cell"},[e._v(e._s(e.cancelText||"取消"))])]):e._e()])],1)},staticRenderFns:[]};var l=i("VU/8")(o,r,!1,function(e){i("s5lM")},null,null);t.a=l.exports},s5lM:function(e,t){}});