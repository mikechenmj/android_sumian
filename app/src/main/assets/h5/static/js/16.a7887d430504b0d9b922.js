webpackJsonp([16],{A1FV:function(t,e){},"Bat+":function(t,e){},f0LG:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("taJy"),a=i("+4yL"),n=i("w3Kk"),o=i("gyMJ"),r=i("o0rJ"),c=i("mHYM"),p=(s.a,a.a,n.a,{data:function(){for(var t=Object(c.a)(),e=[],i=[],s=0;s<24;s++)s<10?e.push("0"+s):e.push(s.toString());for(var a=0;a<60;a++)a<10?i.push("0"+a):i.push(a.toString());return{env:t,isShowPicker:!1,dataPicker:{title:"起床时间",type:"getUp",dataSource:{itemList:[e,i],model:["07","00"],columns:void 0}},getUpAt:"",sleepAt:"",systemSleepAt:"",prescription:{},isShowDialog:!1,dialogTitle:"",dialogContent:""}},components:{Picker:s.a,PickerSleepDoctor:a.a,ConfirmDialog:n.a},methods:{showPicker:function(){this.isShowPicker=!0},changePicker:function(t){if("getUp"===this.dataPicker.type)if(parseInt(t.data[0])>12||12===parseInt(t.data[0])&&parseInt(t.data[1])>0)this.isShowDialog=!0,this.dialogTitle="起床时间设置较晚",this.dialogContent="你确定要在 "+t.data.join(":")+" 起床吗？";else{this.getUpAt=t.data.join(":");var e=this.computeSleepAt(t.data);this.sleepAt=e,this.systemSleepAt=e,this.onPickerHide()}else this.sleepAt=t.data.join(":"),this.onPickerHide()},onPickerHide:function(){this.isShowPicker=!1},dialogConfirm:function(){this.getUpAt=this.dataPicker.dataSource.model.join(":");var t=this.computeSleepAt(this.dataPicker.dataSource.model);this.sleepAt=t,this.systemSleepAt=t,this.dialogCancel(),this.onPickerHide()},dialogCancel:function(){this.isShowDialog=!1},edit:function(t){var e=[],i=[],s=this.getUpAt.split(":"),a=this.sleepAt.split(":");e.push(s[0]),e.push(s[1]),i.push(a[0]),i.push(a[1]),this.isShowPicker=!0,this.dataPicker.type=t,this.dataPicker.title="getUp"===t?"起床时间":"就寝时间",this.dataPicker.dataSource.model="getUp"===t?e:i},computeSleepAt:function(t){var e=60*(60*parseInt(t[0])+parseInt(t[1]))-this.prescription.sleep_prescription.sleep_duration_avg,i=void 0,s=void 0,a=24,n=60;return e>-60?(i=parseInt(e/60/60),s=parseInt(e/60%60),a=i<10?"0"+i:i.toString(),n=s<10?"0"+s:s.toString()):(e=-e,i=parseInt(e/60/60),(s=parseInt(e/60%60))>0?(n=n-s<10?"0"+(n-s):(n-s).toString(),a-=1):0===s&&(n="00"),i>0?a=a-i<10?"0"+(a-i):(a-i).toString():0===i&&(a="23")),a+":"+n},finish:function(){var t=this;if(""!==this.getUpAt&&""!==this.sleepAt){var e={get_up_at:this.getUpAt,sleep_at:this.sleepAt,sleep_duration_avg:this.prescription.sleep_prescription.sleep_duration_avg};o.a.post("sleep-prescriptions",e).then(function(e){2===Object(c.a)()?(Object(r.a)(function(t){t.callHandler("showToast",{type:"text",message:"设置成功",duration:1e3})}),Object(r.a)(function(t){t.callHandler("sleepPrescriptionUpdated",{code:0,result:e.data})})):(t.$vux.toast.text("设置成功"),t.$router.go(-1))}).catch(function(e){2===Object(c.a)()&&Object(r.a)(function(t){t.callHandler("showToast",{type:"text",message:e.message,duration:1e3})}),t.$vux.toast.text(e.message)})}},getPrescription:function(){var t=this;o.a.get("sleep-prescriptions").then(function(e){t.prescription=e.data,t.getUpAt=t.prescription.sleep_prescription.get_up_at?t.prescription.sleep_prescription.get_up_at:"",t.sleepAt=t.prescription.sleep_prescription.sleep_at?t.prescription.sleep_prescription.sleep_at:"",t.systemSleepAt=t.computeSleepAt(t.getUpAt.split(":"))})}},created:function(){this.getPrescription()}}),l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"prescription_page",class:{appHeight:2===t.env}},[i("div",{staticClass:"title"},[t._v("我的睡眠处方")]),t._v(" "),i("div",{staticClass:"description"},[t._v("系统已根据您的睡眠日记规划处方，请坚持")]),t._v(" "),i("div",{staticClass:"label",staticStyle:{"margin-top":"0"}},[t._v("起床时间")]),t._v(" "),""===t.getUpAt?i("div",{staticClass:"picker_wrapper",on:{click:t.showPicker}},[t._v("在此设置起床时间")]):i("div",{staticClass:"picker_wrapper time",on:{click:function(e){t.edit("getUp")}}},[t._v("\n    "+t._s(t.getUpAt)+"\n    "),i("span",{staticClass:"edit"},[i("svg-icon",{attrs:{"icon-class":"sleepprescription_icon_modify"}})],1)]),t._v(" "),""===t.getUpAt?i("div",{staticClass:"remark"},[t._v("设置起床时间后，系统将为您计算合适的就寝时间")]):t._e(),t._v(" "),""!==t.sleepAt?i("div",[i("div",{staticClass:"label",staticStyle:{"margin-top":"1.2rem"}},[t._v("就寝时间")]),t._v(" "),i("div",{staticClass:"picker_wrapper time",on:{click:function(e){t.edit("sleep")}}},[t._v("\n      "+t._s(t.sleepAt)+"\n      "),i("span",{staticClass:"edit"},[i("svg-icon",{attrs:{"icon-class":"sleepprescription_icon_modify"}})],1)]),t._v(" "),this.prescription.former?i("div",{staticClass:"remark"},[t._v("您上周睡眠数据不足三天，系统将沿用更早以前的数据为您提供建议。")]):t._e()]):t._e(),t._v(" "),""!==t.sleepAt&&t.sleepAt!==t.systemSleepAt?i("div",{staticClass:"warning"},[i("svg-icon",{staticStyle:{"margin-right":".1rem"},attrs:{"icon-class":"toast_icon_caveat"}}),t._v("\n    系统建议就寝时间为 "+t._s(t.systemSleepAt)+"\n  ")],1):t._e(),t._v(" "),i("div",{staticClass:"finish",style:{background:""===t.getUpAt||""===t.sleepAt?"#E3E5E6":"#6595F4",color:""===t.getUpAt||""===t.sleepAt?"#878D99":"#FFFFFF"},on:{click:t.finish}},[t._v("确定")]),t._v(" "),i("picker-sleep-doctor",{attrs:{title:t.dataPicker.title,submitText:"确定",isShow:t.isShowPicker,dataSource:t.dataPicker.dataSource},on:{"on-submit":t.changePicker,"on-hide":t.onPickerHide}}),t._v(" "),i("confirm-dialog",{attrs:{isShow:t.isShowDialog,title:t.dialogTitle,content:t.dialogContent},on:{hideDialog:t.dialogCancel,onOk:t.dialogConfirm}})],1)},staticRenderFns:[]};var d=i("VU/8")(p,l,!1,function(t){i("A1FV")},null,null);e.default=d.exports},w3Kk:function(t,e,i){"use strict";var s=i("/kga"),a=i("2sLL"),n=(s.a,a.a,s.a,{name:"confirm-dialog",components:{XDialog:s.a,XButton:a.a},comments:{XDialog:s.a},data:function(){return{}},props:["isShow","type","title","content","cancelText","okText"],methods:{handleCancel:function(){this.$emit("hideDialog",this.type)},handleOk:function(){this.$emit("onOk",this.type)}}}),o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[i("x-dialog",{staticClass:"confirm_dialog",model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[i("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),i("div",{staticClass:"content"},[t._v(t._s(t.content))]),t._v(" "),i("div",{staticClass:"btn_wrap"},["stop"!==t.type&&"update"!==t.type?i("XButton",{staticClass:"btn no",nativeOn:{click:function(e){return t.handleCancel(e)}}},[t._v(t._s(t.cancelText?t.cancelText:"取消"))]):t._e(),t._v(" "),i("XButton",{staticClass:"btn yes",style:{width:"stop"===t.type||"update"===t.type?"6.1rem":"3rem",float:"stop"===t.type||"update"===t.type?"none":"right"},nativeOn:{click:function(e){return t.handleOk(e)}}},[t._v(t._s(t.okText?t.okText:"确定"))])],1)])],1)},staticRenderFns:[]};var r=i("VU/8")(n,o,!1,function(t){i("Bat+")},null,null);e.a=r.exports}});
//# sourceMappingURL=16.a7887d430504b0d9b922.js.map