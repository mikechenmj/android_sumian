webpackJsonp([5,32],{"+w79":function(t,e){},AoEW:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("2sLL"),n=s("rHil"),a=s("1DHf"),r=s("32ER"),c=s("o0rJ"),l=s("mHYM"),o=(i.a,n.a,a.a,r.a,String,{name:"cbti-result",components:{XButton:i.a,Group:n.a,Cell:a.a,CellBox:r.a},props:{type:{type:String,default:"judgment"},resultData:null,exercises:null},computed:{checkBoxComment:{get:function(){return"checkbox"===this.type?this.exercises.final_words.replace(/\n/g,"<br>"):""}},checkboxData:{get:function(){var t=this,e=[];return"checkbox"===this.type&&this.resultData.map(function(s,i){var n=t.exercises.data[i],a={title:n.final_question_perform,answer:[]};s.split(",").map(function(t){""===t?a.answer.push("——"):a.answer.push("• "+n.selection[t])}),e.push(a)}),e}}},created:function(){console.log(this.resultData,this.exercises,"cbti-result.vue",this.checkBoxComment)},methods:{returnRouter:function(){2!==Object(l.a)()?this.$router.go(-1):Object(c.a)(function(t){t.callHandler("return",{})})}}}),u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cbti-result"},["judgment"===t.type?s("div",{staticClass:"Judgment"},[s("p",{staticClass:"title"},[t._v("\n      以下描述您觉得是否正确？正确请选“✓”，错误请选“✗”\n    ")]),t._v(" "),s("div",{staticClass:"content"},[s("svg-icon",{staticClass:"cbti_icon_success",attrs:{"icon-class":"cbti_icon_success"}}),t._v(" "),s("p",[t._v("恭喜你已完成练习")]),t._v(" "),s("div",{on:{click:function(e){t.$emit("resultSubmit","judgment")}}},[s("x-button",{staticClass:"submit",attrs:{type:"primary"}},[t._v("完成")])],1)],1)]):t._e(),t._v(" "),"displayQuestions"===t.type?s("div",{staticClass:"Judgment"},[s("p",{staticClass:"title"},[t._v("\n      你是否有以下的行为习惯? 正确请选“✓”，错误请选“✗”\n    ")]),t._v(" "),s("div",{staticClass:"content"},[s("svg-icon",{staticClass:"cbti_icon_success",attrs:{"icon-class":"cbti_icon_success"}}),t._v(" "),s("p",[t._v("恭喜你已完成练习")]),t._v(" "),s("div",{on:{click:function(e){t.$emit("resultSubmit","displayQuestions")}}},[s("x-button",{staticClass:"submit",attrs:{type:"primary"}},[t._v("完成")])],1)],1)]):t._e(),t._v(" "),t.resultData&&"scale"===t.type?s("div",{staticClass:"scale"},[s("group",[s("cell",{attrs:{title:"测评结果"}},[s("div",{staticClass:"checkbox-reset",on:{click:function(e){t.$emit("resultSubmit","scale")}}},[t._v("重填")])]),t._v(" "),s("cell-box",[s("p",{staticClass:"result"},[t._v(t._s(t.resultData.result.result))]),t._v(" "),s("p",{staticClass:"score"},[t._v("测评分数："+t._s(t.resultData.result.score)+"分")])]),t._v(" "),s("cell-box",[s("p",{staticClass:"time"},[t._v("\n          测评时间："+t._s(t.$moment.unix(t.resultData.result.updated_at).format("YYYY.MM.DD HH:mm"))+"\n        ")]),t._v(" "),s("p",{staticClass:"comment"},[t._v("\n          测评建议："+t._s(t.resultData.result.comment)+"\n        ")])])],1),t._v(" "),s("div",{on:{click:t.returnRouter}},[s("x-button",{staticClass:"submit-btn",attrs:{type:"primary"}},[t._v("完成")])],1)],1):t._e(),t._v(" "),"checkbox"===t.type?s("div",{staticClass:"checkbox"},[s("group",[s("cell",{attrs:{title:"结果"}},[s("div",{staticClass:"checkbox-reset",on:{click:function(e){t.$emit("resultSubmit","checkbox")}}},[t._v("重填")])]),t._v(" "),s("cell-box",[s("p",{staticClass:"time"},[t._v("\n          完成时间："+t._s(t.$moment().format("YYYY.MM.DD HH:mm"))+"\n        ")]),t._v(" "),s("div",{staticClass:"comment"},t._l(t.checkboxData,function(e){return s("div",{key:e.id},[s("p",[t._v(t._s(e.title))]),t._v(" "),t._l(e.answer,function(e){return s("p",{key:e.id},[t._v(t._s(e))])}),t._v(" "),s("br")],2)}))])],1),t._v(" "),t.exercises.final_words?s("group",[s("cell",{attrs:{title:"结果分析"}}),t._v(" "),s("cell-box",[s("div",{staticClass:"comment",domProps:{innerHTML:t._s(t.checkBoxComment)}})])],1):t._e(),t._v(" "),s("div",{on:{click:t.returnRouter}},[s("x-button",{staticClass:"submit-btn",attrs:{type:"primary"}},[t._v("完成")])],1)],1):t._e(),t._v(" "),"pickUpThePost"===t.type?s("div",{staticClass:"Judgment"},[0!==t.exercises.data.type?s("div",[s("p",{staticClass:"title"},[t._v("\n        恭喜你，距离好睡眠又进一步！\n      ")]),t._v(" "),s("div",{staticClass:"content"},[s("svg-icon",{staticClass:"cbti_icon_success",attrs:{"icon-class":"cbti_icon_success"}}),t._v(" "),s("p",[t._v("\n          "+t._s(0===t.exercises.data.data.length?"你没有不合理信念，请继续保持":"恭喜你已完成练习")+"\n        ")]),t._v(" "),s("div",{on:{click:function(e){t.$emit("resultSubmit","pickUpThePost")}}},[s("x-button",{staticClass:"submit",attrs:{type:"primary"}},[t._v("完成")])],1)],1)]):s("div",[s("p",{staticClass:"title"},[t._v("\n        "+t._s(t.exercises.data.final_page.title)+"\n      ")]),t._v(" "),s("div",{staticClass:"content"},[s("p",{staticStyle:{height:"4.97rem","line-height":"4.97rem","padding-top":".4rem"}},[t._v("\n          "+t._s(t.exercises.data.final_page.result)+"\n        ")]),t._v(" "),s("div",{on:{click:function(e){t.$emit("resultSubmit","pickUpThePost")}}},[s("x-button",{staticClass:"submit",staticStyle:{"margin-top":"1rem"},attrs:{type:"primary"}},[t._v(t._s(t.exercises.data.final_page.button))])],1)])])]):t._e(),t._v(" "),"sleepSituation"===t.type?s("div",{staticClass:"checkbox"},[s("group",[s("cell",{attrs:{title:"结果"}},[s("div",{staticClass:"checkbox-reset",on:{click:function(e){t.$emit("resultSubmit","sleepSituation")}}},[t._v("重填")])]),t._v(" "),s("cell-box",[s("p",{staticClass:"time"},[t._v("\n          完成时间："+t._s(t.$moment().format("YYYY.MM.DD HH:mm"))+"\n        ")]),t._v(" "),s("div",{staticClass:"comment"},t._l(t.resultData,function(e,i){return s("div",{key:e.id},[s("p",[t._v(t._s(t.exercises.data[i].question))]),t._v(" "),s("p",[t._v("• "+t._s(t.exercises.data[i].selection[e]))]),t._v(" "),s("br")])}))])],1),t._v(" "),t.exercises.final_words?s("group",[s("cell",{attrs:{title:"结果分析"}}),t._v(" "),s("cell-box",[s("div",{staticClass:"comment",domProps:{innerHTML:t._s(t.checkBoxComment)}})])],1):t._e(),t._v(" "),s("div",{on:{click:t.returnRouter}},[s("x-button",{staticClass:"submit-btn",attrs:{type:"primary"}},[t._v("完成")])],1)],1):t._e()])},staticRenderFns:[]};var p=s("VU/8")(o,u,!1,function(t){s("Bwfg")},null,null);e.default=p.exports},Bwfg:function(t,e){},FdIl:function(t,e){},H3kw:function(t,e){},Qb34:function(t,e,s){"use strict";var i=s("mvHQ"),n=s.n(i),a=s("0YqE"),r=s("ALGc"),c=s("rHil"),l=s("3BeM"),o=s("gyMJ"),u=s("o0rJ"),p=s("mHYM"),h=(a.a,r.a,c.a,l.a,{name:"scale-question",components:{DatetimeView:a.a,XTextarea:r.a,Group:c.a,ToastPlugin:l.a},data:function(){return{scaleType:0,scaleIndex:0,answers:[],noSubmit:!1,setTimeout:null}},props:["scaleQuestionData","type","scalesIds"],created:function(){console.log(this.scaleQuestionData,"scaleQuestionData")},mounted:function(){var t=this;if(this.scaleQuestionData){this.scaleQuestionData.map(function(e){var s={question_id:e.id,answer:null};1!==e.type&&2!==e.type||(s.answer=e.default_value||"08:00"),t.answers.push(s)}),this.handleScaleType();var e=this.$route.params.id;"scales"===this.$route.params.id&&(e=this.$route.query.scale_id);var s=localStorage.getItem("answers_scale_"+e);s&&(this.answers=JSON.parse(s));var i=localStorage.getItem("scaleIndex_"+e);i&&(this.scaleIndex=JSON.parse(i))}},watch:{scaleIndex:function(t){var e=this.$route.params.id;"scales"===this.$route.params.id&&(e=this.$route.query.scale_id),localStorage.setItem("answers_scale_"+e,n()(this.answers)),localStorage.setItem("scaleIndex_"+e,n()(t))}},methods:{optionSelect:function(t,e){var s=this;this.answers[t].answer=e,this.answers.length!==this.scaleIndex+1&&(this.setTimeout||(this.setTimeout=setTimeout(function(){s.plus()},300)))},handleScaleType:function(){var t=this.scaleQuestionData[this.scaleIndex].type;this.scaleType=t||0,1===this.scaleType&&this.$refs.datetime1&&this.$refs.datetime1.render(),2===this.scaleType&&this.$refs.datetime2&&this.$refs.datetime2.render()},reduce:function(){this.scaleIndex-=1,this.handleScaleType()},plus:function(){this.scaleError()&&(this.scaleIndex+=1,this.handleScaleType(),console.log(this.answers),this.setTimeout=null)},scaleError:function(){if(!this.noSubmit){var t=this.answers[this.scaleIndex].answer;if(null===t||""===t){if(0===this.scaleType)return this.$vux.toast.text("请选择答案","middle"),!1;if(3===this.scaleType)return this.$vux.toast.text("请输入您的回答","middle"),!1}return!0}},submit:function(){var t=this;if(this.scaleError()){if(console.log(this.type,"this.type"),"cbti"===this.type)return void this.$parent.$emit("overFn","scale",this.answers);if("scales"===this.type){var e=JSON.parse(n()(this.scalesIds));e.forEach(function(e){e.answers.forEach(function(e){t.answers.forEach(function(t){e.question_id===t.question_id&&(e.answer=t.answer)})})}),e.forEach(function(t){t.answers.map(function(t){t.question_id=t.question_id.split("_")[0]})});var s={answers:n()(e),chapter_id:this.$route.query.chapter_id};return this.$route.query.cbti_id&&(s.cbti_id=this.$route.query.cbti_id),void o.a.post("/scale-distributions-answers/",s).then(function(e){t.$store.dispatch("GetCbtiChapters").then(function(t){console.log(t)}),console.log(e,"submit res"),2===Object(p.a)()?Object(u.a)(function(s){s.callHandler("scaleFinishFilling",{code:0,message:"成功",result:e.data}),t.$parent.getScales()}):t.$parent.getScales(),t.noSubmit=!1}).catch(function(e){console.log(e),t.noSubmit=!1})}this.noSubmit=!0,o.a.post("/scale-distributions/"+this.$route.params.id+"/answers",{include:0===Number(this.$route.query.scale_result_id)?"scale.questions":"scale.comments",answers:n()(this.answers)}).then(function(e){console.log(e,"submit res");var s=e.data.id;2===Object(p.a)()?Object(u.a)(function(i){i.callHandler("scaleFinishFilling",{code:0,message:"成功",result:e.data}),t.$parent.getScaleDistributions(s)}):t.$parent.getScaleDistributions(s),t.noSubmit=!1}).catch(function(e){console.log(e),t.noSubmit=!1})}}}}),d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.scaleQuestionData?i("div",{attrs:{id:"scale-question"}},[t.scaleQuestionData?i("div",{staticClass:"question-title"},[t._v("\n    "+t._s(t.scaleQuestionData[t.scaleIndex].question)+"\n  ")]):t._e(),t._v(" "),i("div",{staticClass:"question-body"},[0===t.scaleType?i("div",{staticClass:"type-0"},[i("div",{staticClass:"options-list",class:{"center-list":!0}},t._l(t.scaleQuestionData[t.scaleIndex].options,function(e){return i("div",{key:e.id,staticClass:"option",on:{click:function(s){t.optionSelect(t.scaleIndex,e.id)}}},[i("svg-icon",{staticClass:"icon-selected",class:t.answers[t.scaleIndex].answer!==e.id?"":"active",attrs:{"icon-class":t.answers[t.scaleIndex].answer!==e.id?"login_icon_unselected":"login_icon_selected"}}),t._v("\n          "+t._s(e.content)+"\n        ")],1)}))]):t._e(),t._v(" "),1===t.scaleType?i("div",{staticClass:"type-1"},[i("DatetimeView",{ref:"datetime1",attrs:{format:"HH:mm"},model:{value:t.answers[t.scaleIndex].answer,callback:function(e){t.$set(t.answers[t.scaleIndex],"answer",e)},expression:"answers[scaleIndex].answer"}})],1):t._e(),t._v(" "),2===t.scaleType?i("div",{staticClass:"type-2"},[i("DatetimeView",{ref:"datetime2",attrs:{format:"HH:mm"},model:{value:t.answers[t.scaleIndex].answer,callback:function(e){t.$set(t.answers[t.scaleIndex],"answer",e)},expression:"answers[scaleIndex].answer"}})],1):t._e(),t._v(" "),t.scaleQuestionData&&3===t.scaleType?i("div",{staticClass:"type-3"},[i("div",{staticClass:"title"},[t._v("填写说明")]),t._v(" "),i("x-textarea",{attrs:{max:200,placeholder:"可在此处描述您的详细情况（200字以内）","show-counter":!1},model:{value:t.answers[t.scaleIndex].answer,callback:function(e){t.$set(t.answers[t.scaleIndex],"answer",e)},expression:"answers[scaleIndex].answer"}})],1):t._e(),t._v(" "),i("div",{staticClass:"jump-btn"},[i("div",{staticClass:"btn-left"},[t.scaleIndex>0?i("img",{attrs:{src:s("mhLV"),alt:""},on:{click:t.reduce}}):t._e()]),t._v(" "),i("div",{staticClass:"btn-submit"},[t.scaleQuestionData&&t.scaleIndex===t.scaleQuestionData.length-1?i("div",{on:{click:t.submit}},[t._v("\n          生成报告\n        ")]):i("p",[t._v("\n          "+t._s(t.scaleIndex+1)+"/"+t._s(t.scaleQuestionData.length)+"\n        ")])]),t._v(" "),i("div",{staticClass:"btn-right"},[t.scaleQuestionData&&t.scaleIndex<t.scaleQuestionData.length-1?i("img",{attrs:{src:s("UQqC"),alt:""},on:{click:t.plus}}):t._e()])])])]):t._e()},staticRenderFns:[]};var m=s("VU/8")(h,d,!1,function(t){s("FdIl")},null,null);e.a=m.exports},Sf5M:function(t,e){},aA4v:function(t,e){},"b+Fa":function(t,e){},bL4F:function(t,e){},j9Kh:function(t,e){},"k/91":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("mvHQ"),n=s.n(i),a=(Array,String,String,Number,{name:"sleep-form-radio",props:{radioData:{type:Array},current:String,page:String,default:{type:Number,default:null}},data:function(){return{selectIndex:null}},watch:{radioData:function(){this.selectIndex=this.default}},methods:{select:function(t){if(this.selectIndex=t,this.current&&this.page&&this.$parent[this.current]<this.$parent[this.page]){var e=[this.radioData[t],t];this.$emit.apply(this,["change"].concat(e))}}},mounted:function(){this.selectIndex=this.default}}),r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sleep-form-radio"},[s("div",{staticClass:"options-list center-list"},t._l(t.radioData,function(e,i){return s("div",{key:e.id,staticClass:"option",on:{click:function(e){t.select(i)}}},[s("svg-icon",{staticClass:"icon-selected",class:t.selectIndex===i?"active":"",attrs:{"icon-class":t.selectIndex===i?"login_icon_selected":"login_icon_unselected"}}),t._v("\n      "+t._s(e.name)+"\n    ")],1)}))])},staticRenderFns:[]};var c=s("VU/8")(a,r,!1,function(t){s("v8rk")},null,null).exports,l=(String,String,String,String,{name:"sleep-form-home",props:{title:{type:String,default:""},text:{type:String,default:""},doctorName:String,buttonText:{type:String,default:""}},methods:{submit:function(){console.log("home submit"),this.$emit("on-submit")}}}),o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sleep-form-home"},[s("div",{staticClass:"sleep-form-bg"},[s("h1",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),s("p",{staticClass:"text"},[t._v(t._s(t.text))]),t._v(" "),t.doctorName?s("p",{staticClass:"doctor"},[t._v("发放医生："+t._s(t.doctorName))]):t._e(),t._v(" "),s("div",{staticClass:"submit",on:{click:t.submit}},[t._v("\n      "+t._s(t.buttonText)+"\n    ")])])])},staticRenderFns:[]};var u=s("VU/8")(l,o,!1,function(t){s("b+Fa")},null,null).exports,p=(Array,String,String,String,{name:"sleep-form-checkbox",props:{checkboxData:{type:Array},current:String,page:String,prop:String},data:function(){return{selectIndex:[]}},created:function(){var t=this;this.checkboxData.map(function(e,s){t.$set(t.checkboxData,s,{active:!1,name:t.checkboxData[s].name,value:t.checkboxData[s].value})})},methods:{select:function(t){var e=t,s=this.selectIndex.find(function(t){return t===e});void 0===s?this.selectIndex.push(e):this.selectIndex.splice(s,1),this.$set(this.checkboxData,e,{active:!this.checkboxData[e].active,name:this.checkboxData[e].name,value:this.checkboxData[e].value}),this.$parent.$parent.result[this.prop]={data:this.checkboxData,type:"checkbox"}}}}),h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sleep-form-checkbox"},[s("div",{staticClass:"options-list",class:{"center-list":t.checkboxData.length<5,"super-height":t.checkboxData.length>10}},t._l(t.checkboxData,function(e,i){return s("div",{key:e.id,staticClass:"option",on:{click:function(e){t.select(i)}}},[s("svg-icon",{staticClass:"icon-selected",class:e.active?"active":"",attrs:{"icon-class":e.active?"login_icon_selected":"login_icon_unselected"}}),t._v("\n      "+t._s(e.name)+"\n    ")],1)}))])},staticRenderFns:[]};var d=s("VU/8")(p,h,!1,function(t){s("x/Fj")},null,null).exports,m=s("jNWb"),v=(m.a,Function,String,Number,String,String,String,String,String,{name:"judgment",components:{SleepDialog:m.a},props:{change:{type:Function},label:{type:String,default:"未设置 label"},answer:{type:Number,default:null},message:{type:String,default:"问题解释"},result:{type:String},prop:{type:String},page:{type:String},current:{type:String}},data:function(){return{select1:null,yes:"cbti_btn_correct_default",no:"cbti_btn_wrong_default",noSelect:!0,dialog:!1,isAnswer:!0}},methods:{handleOk:function(){this.$parent[this.page]>this.$parent[this.current]+1?(this.$parent[this.current]++,this.dialog=!1,this.noSelect=!0,this.yes="cbti_btn_correct_default",this.no="cbti_btn_wrong_default",this.$parent.$parent[this.result][this.prop].data.push(Boolean(!this.select1)),this.select1=null):(this.$parent.$parent[this.result][this.prop].data.length<this.$parent[this.page]&&this.$parent.$parent[this.result][this.prop].data.push(Boolean(!this.select1)),this.$emit("overFn",this.$parent.$parent[this.result][this.prop].data))},select:function(t){this.noSelect&&(this.select1=t,this.noSelect=!1,this.dialog=!0,t===this.answer?0===t?(this.isAnswer=!0,this.yes="cbti_btn_correct_blue"):(this.isAnswer=!0,this.no="cbti_btn_wrong_blue"):t!==this.answer&&(0===t?(this.isAnswer=!1,this.yes="cbti_btn_correct_red"):(this.isAnswer=!1,this.no="cbti_btn_wrong_red")),this.change(t))}},created:function(){}}),_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"judgment"},[s("div",{staticClass:"text"},[t._v("\n    "+t._s(t.label)+"\n  ")]),t._v(" "),s("div",{staticClass:"judgment-select"},[s("div",{on:{click:function(e){t.select(0)}}},[s("svg-icon",{staticClass:"svg-icon left",attrs:{"icon-class":t.yes}})],1),t._v(" "),s("div",{on:{click:function(e){t.select(1)}}},[s("svg-icon",{staticClass:"svg-icon",attrs:{"icon-class":t.no}})],1)]),t._v(" "),s("sleep-dialog",{attrs:{cancel:!1},on:{handleOk:t.handleOk},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("div",{staticClass:"judgment-dialog",attrs:{slot:"content"},slot:"content"},[s("p",{staticClass:"title"},[t._v(t._s(t.label))]),t._v(" "),t.isAnswer?s("div",{staticClass:"success"},[t._v("✓ 你答对了")]):s("div",{staticClass:"error"},[t._v("✗ 你答错了")]),t._v(" "),s("div",{staticClass:"content-zi"},[t._v("\n        解释："+t._s(t.message)+"\n      ")])])])],1)},staticRenderFns:[]};var g=s("VU/8")(v,_,!1,function(t){s("Sf5M")},null,null).exports,f=(m.a,Function,String,Number,String,String,String,String,String,{name:"display-questions",components:{SleepDialog:m.a},props:{change:{type:Function},label:{type:String,default:"未设置 label"},answer:{type:Number,default:null},message:{type:String,default:"问题解释"},result:{type:String},prop:{type:String},page:{type:String},current:{type:String}},data:function(){return{select1:null,yes:"cbti_btn_correct_default",no:"cbti_btn_wrong_default",noSelect:!0,dialog:!1}},methods:{handleOk:function(){this.$parent[this.page]>this.$parent[this.current]+1?(this.$parent[this.current]++,this.dialog=!1,this.noSelect=!0,this.yes="cbti_btn_correct_default",this.no="cbti_btn_wrong_default",this.$parent.$parent[this.result][this.prop].data.push(Boolean(!this.select1)),this.select1=null):(this.$parent.$parent[this.result][this.prop].data.length<this.$parent[this.page]&&this.$parent.$parent[this.result][this.prop].data.push(Boolean(!this.select1)),this.$emit("overFn",this.$parent.$parent[this.result][this.prop].data))},select:function(t){var e=this;this.noSelect&&(this.select1=t,this.noSelect=!1,0===t?(this.dialog=!0,this.yes="cbti_btn_correct_red"):(this.no="cbti_btn_wrong_blue",setTimeout(function(){e.$parent[e.page]>e.$parent[e.current]+1?(e.$parent[e.current]++,e.yes="cbti_btn_correct_default",e.no="cbti_btn_wrong_default",e.noSelect=!0,e.$parent.$parent[e.result][e.prop].data.length<e.$parent[e.page]&&e.$parent.$parent[e.result][e.prop].data.push(Boolean(!e.select1)),e.select1=null):(e.$parent.$parent[e.result][e.prop].data.length<e.$parent[e.page]&&e.$parent.$parent[e.result][e.prop].data.push(Boolean(!e.select1)),e.$emit("overFn",e.$parent.$parent[e.result][e.prop].data))},400)),this.change(t))}},created:function(){}}),b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"display-questions"},[s("div",{staticClass:"text"},[t._v("\n    "+t._s(t.label)+"\n  ")]),t._v(" "),s("div",{staticClass:"judgment-select"},[s("div",{on:{click:function(e){t.select(0)}}},[s("svg-icon",{staticClass:"svg-icon left",attrs:{"icon-class":t.yes}})],1),t._v(" "),s("div",{on:{click:function(e){t.select(1)}}},[s("svg-icon",{staticClass:"svg-icon",attrs:{"icon-class":t.no}})],1)]),t._v(" "),s("sleep-dialog",{attrs:{cancel:!1},on:{handleOk:t.handleOk},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("div",{staticClass:"judgment-dialog",attrs:{slot:"content"},slot:"content"},[s("p",{staticClass:"title"},[t._v(t._s(t.label))]),t._v(" "),s("p",{staticClass:"error"},[t._v("这是不好的习惯哦。")]),t._v(" "),s("div",{staticClass:"content-zi"},[t._v("\n        解释："+t._s(t.message)+"\n      ")])])])],1)},staticRenderFns:[]};var x=s("VU/8")(f,b,!1,function(t){s("bL4F")},null,null).exports,y=s("Qb34"),S=(String,Number,String,Number,String,{name:"pickUpThePost",data:function(){return{}},props:{selection:String,current:Number,explanation:String,page:Number,toast:String}}),k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pickUpThePost"},[s("div",{staticClass:"pickUpThePost-content"},[t._v("\n    "+t._s(t.explanation)+"\n  ")]),t._v(" "),s("div",{staticClass:"pickUpThePost-toast"},[s("p",[t._v("应对方法：")]),t._v(" "),s("p",[t._v(t._s(t.toast))])])])},staticRenderFns:[]};var w=s("VU/8")(S,k,!1,function(t){s("j9Kh")},null,null).exports,C=s("taJy"),$=s("+4yL"),T=($.a,C.a,String,Array,{name:"SleepSituation",data:function(){return{selectText:[]}},computed:{selectArr:function(){var t=this,e=[];return this.pickerData.forEach(function(t){var s,i="",n="",a=t.length,r=t.replace(/[^\d+(.\d+)?]/gi,""),c=t.indexOf(r);c>0&&(i='<span style="position: absolute;font-size: .28rem;font-family: PingFangSC-Regular;color: #6595F4;right: 50%;margin-right: .7rem;top: 0.08rem;">'+t.substring(0,c)+"</span>");a-(c+r.length)>0&&(n='<span  style="position: absolute;font-size: .28rem;font-family: PingFangSC-Regular;color: #6595F4;left: 50%;margin-left: .7rem;top: 0.08rem;">'+t.substring(c+r.length,t.length)+"</span>");s='<div style="position: relative;">'+i+"<span>"+r+"</span>"+n+"</div>",e.push(s)}),this.$nextTick(function(){t.$refs.datetime.render()}),e}},components:{PickerSleepDoctor:$.a,Picker:C.a},methods:{change1:function(t){var e=0;this.selectArr.forEach(function(s,i){s===t[0]&&(e=i)}),console.log(t,e,"123123123"),this.$emit("change",e)}},props:{title:{type:String},pickerData:{type:Array}}}),D={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"SleepSituation"},[s("div",{staticClass:"SleepSituation-title"},[t._v(t._s(t.title))]),t._v(" "),s("picker",{ref:"datetime",attrs:{data:t.selectArr,columns:1},on:{"on-change":t.change1},model:{value:t.selectText,callback:function(e){t.selectText=e},expression:"selectText"}})],1)},staticRenderFns:[]};var F=s("VU/8")(T,D,!1,function(t){s("aA4v")},null,null).exports,I=(y.a,Array,Boolean,String,Object,Boolean,Boolean,String,{name:"",components:{Home:u,Judgment:g,DisplayQuestions:x,Radio:c,Checkbox:d,scaleQuestion:y.a,PickUpThePost:w,SleepSituation:F},methods:{homeSubmit:function(){this.showHome=!1,this.showType?this.home.callback(this.showType):this.home.callback()},reduce:function(){this.current-=1},plus:function(){this.current+1<this.page&&(this.current+=1)},change:function(t,e){this.$parent[this.result][this.items[this.current].prop]=t,this.$parent.items[this.current].default=e},sleepSituationChange:function(t){this.$parent[this.result].sleepSituation.data[this.current]=t,this.$parent.resultData[this.current]=t,console.log("sleepSituationChange",t)}},props:{items:{type:Array},itemTitle:{type:Boolean,default:!0},result:{type:String},home:{type:Object,default:null},isSelect:{type:Boolean,default:!0},isSubmitBtn:{type:Boolean,default:!0},SubmitBtnTxt:{type:String,default:"生成报告"}},data:function(){return{showData:{},showHome:!0,current:0}},computed:{showType:{get:function(){return this.items?this.items[this.current].type:null}},page:{get:function(){return this.items.length}}},created:function(){}}),j={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sleep-form"},[t.home&&t.showHome?i("home",{attrs:{doctorName:t.home.doctor,text:t.home.text,buttonText:t.home.buttonText,title:t.home.title},on:{"on-submit":t.homeSubmit}}):t._e(),t._v(" "),t.showHome||"scale"===t.showType?t._e():i("div",{staticClass:"question",style:{paddingTop:t.itemTitle?"":".8rem"}},[t.itemTitle?i("div",{staticClass:"sleep-form-header"},[t._v("\n      "+t._s(t.items[t.current].title)+"\n    ")]):t._e(),t._v(" "),i("div",{staticClass:"sleep-form-bg"},["radio"===t.showType?i("radio",{attrs:{radioData:t.items[t.current].data,current:"current",page:"page",default:t.items[t.current].default},on:{change:t.change}}):t._e(),t._v(" "),"checkbox"===t.showType?i("checkbox",{attrs:{checkboxData:t.items[t.current].data,current:"current",page:"page",prop:t.items[t.current].prop,result:t.result},on:{change:t.change}}):t._e(),t._v(" "),"judgment"===t.showType?i("judgment",{attrs:{answer:t.items[t.current].answer,label:t.items[t.current].label,change:t.items[t.current].change,message:t.items[t.current].message,current:"current",page:"page",prop:t.items[t.current].prop,result:t.result},on:{overFn:function(e){t.$emit("overFn",t.showType,t.items[t.current].prop)}}}):t._e(),t._v(" "),"displayQuestions"===t.showType?i("display-questions",{attrs:{answer:t.items[t.current].answer,label:t.items[t.current].label,change:t.items[t.current].change,message:t.items[t.current].message,current:"current",page:"page",prop:t.items[t.current].prop,result:t.result},on:{overFn:function(e){t.$emit("overFn",t.showType,t.items[t.current].prop)}}}):t._e(),t._v(" "),"pickUpThePost"===t.showType?i("pick-up-the-post",{attrs:{selection:t.items[t.current].selection,explanation:t.items[t.current].explanation,toast:t.items[t.current].toast,current:t.current,page:t.page}}):t._e(),t._v(" "),"sleepSituation"===t.showType?i("sleep-situation",{attrs:{title:t.items[t.current].data.title,pickerData:t.items[t.current].data.selection},on:{change:t.sleepSituationChange}}):t._e(),t._v(" "),i("div",{staticClass:"jump-btn"},[i("div",{staticClass:"btn-left"},[t.isSelect&&t.current+1>1?i("img",{attrs:{src:s("mhLV"),alt:""},on:{click:t.reduce}}):t._e()]),t._v(" "),i("div",{staticClass:"btn-submit"},[t.isSubmitBtn&&t.current+1===t.page?i("div",{staticClass:"btn",on:{click:function(e){t.$emit("overFn",t.showType)}}},[t._v("\n            "+t._s(t.SubmitBtnTxt)+"\n          ")]):i("div",{staticClass:"page"},[t._v("\n            "+t._s(t.current+1)+"/"+t._s(t.page)+"\n          ")])]),t._v(" "),i("div",{staticClass:"btn-right"},[t.isSelect&&t.current+1<t.page?i("img",{attrs:{src:s("UQqC"),alt:"reduce"},on:{click:t.plus}}):t._e()])])],1)]),t._v(" "),t.showHome||"scale"!==t.showType?t._e():i("scale-question",{attrs:{type:"cbti",scaleQuestionData:t.items[t.current].data}})],1)},staticRenderFns:[]};var Q=s("VU/8")(I,j,!1,function(t){s("H3kw")},null,null).exports,H=s("AoEW"),U=s("gyMJ"),B=s("o0rJ"),q=s("mHYM"),P=(H.default,{name:"exercises",data:function(){return{resultType:null,result:{answer:[],final_words:"恭喜您，对睡眠知识有了初步的了解~ 接下来我们会继续与您一同了解失眠，抵抗失眠！"},items:null,home:{title:"loding",text:"loding",doctor:"",buttonText:"loding",callback:this.homeCallback},isSelect:!0,isSubmitBtn:!0,itemTitle:!0,resultData:{},exercises:{},exerciseAnswers:null,SubmitBtnTxt:"生成报告"}},components:{SleepForm:Q,cbtiResult:H.default},created:function(){var t=this;this.getExercises(this.$route.query.id).then(function(e){switch(document.title=e.title,t.exercises=e,t.setHome(e.guide),e.type){case 0:t.isSubmitBtn=!1,t.isSelect=!1,t.handleJudgment(e);break;case 1:t.isSubmitBtn=!0,t.isSelect=!0,t.SubmitBtnTxt="提交",t.handleCheckbox(e);break;case 2:t.handleRadio(e);break;case 3:t.handleHref(e);break;case 4:t.isSubmitBtn=!1,t.isSelect=!1,t.displayQuestions(e);break;case 5:t.SubmitBtnTxt="我知道了",t.pickUpThePost(e);break;case 6:t.SubmitBtnTxt="提交",t.sleepSituation(e);break;default:console.log("类型错误")}})},methods:{homeCallback:function(t){0===this.exercises.data.type?this.resultType="pickUpThePost":"pickUpThePost"!==t||this.exercises.exercise_is_filled||0!==this.exercises.data.data.length?"pickUpThePost"===t&&0===this.exercises.data.data.length&&(this.resultType="pickUpThePost"):(this.resultType="pickUpThePost",this.overFn("pickUpThePost")),console.log(t,"home callback")},resultSubmit:function(t){var e=this,s=Object(q.a)();"judgment"===t?2===s?Object(B.a)(function(t){t.callHandler("onQuestionFinished",{code:0,message:"onQuestionFinished OK",result:e.exerciseAnswers})}):this.$router.go(-1):"displayQuestions"===t?2===s?Object(B.a)(function(t){t.callHandler("onQuestionFinished",{code:0,message:"onQuestionFinished OK",result:e.exerciseAnswers})}):this.$router.go(-1):"pickUpThePost"===t?2===s?Object(B.a)(function(t){t.callHandler("onQuestionFinished",{code:0,message:"onQuestionFinished OK",result:e.exerciseAnswers})}):this.$router.go(-1):this.resultType=null},overFn:function(t,e){var s=this;this.resultType=t;var i={data:null};if("judgment"===t&&(i.data=this.result[e].data),"displayQuestions"===t&&(i.data=this.result[e].data),"checkbox"===t){var a=[],r=function(t){var e=[];s.result[t].data&&s.result[t].data.map(function(t){t.active&&e.push(t.value)}),a.push(e.join(","))};for(var c in this.result)r(c);i.data=a,this.resultData=i.data}return"scale"===t&&(i.data=e),i.data=n()(i.data),"pickUpThePost"===t&&(i.data=!0),"href"===t&&(i.data=!0),"sleepSituation"===t&&(i.data=n()(this.result.sleepSituation.data)),console.log(this.resultData),U.a.post("cbti-course/"+this.$route.query.id+"/exercise-answers",i).then(function(e){s.exerciseAnswers=e.data,"scale"===t&&(s.resultData=e.data)})},handleJudgment:function(t){var e=this;this.items=[],this.result={},this.result.j1={type:"judgment",data:[]},t.data.map(function(t){var s={title:"以下描述您觉得是否正确？正确请选“✓”，错误请选“✗”",label:t.question,type:"judgment",answer:t.answer?0:1,prop:"j1",message:t.explanation,change:function(t){console.log(t,"judgment callback")}};e.items.push(s)})},handleCheckbox:function(t){var e=this;t.exercise_is_filled&&(this.resultType="checkbox",this.resultData=[],t.data.map(function(t){e.resultData.push(t.user_answer)})),this.items=[],this.result={},t.data.map(function(t,s){var i=[];t.selection.map(function(t,e){var s={};s.value=e,s.name=t,i.push(s)});var n={title:t.question,type:"checkbox",prop:"c_"+s,data:i};e.result[n.prop]={type:"checkbox"},e.items.push(n)})},handleRadio:function(t){t.exercise_is_filled&&(this.resultType="scale",this.resultData=t.data.scale_distributions),this.items=[],this.result={};var e={title:"123123",type:"scale",prop:"scale",data:t.data.questions};this.result[e.prop]={type:"scale"},this.items.push(e)},getQueryString:function(t,e){var s=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),i=t.match(s);return null!=i?i[2]:null},handleHref:function(t){2===Object(q.a)()&&Object(B.a)(function(t){t.callHandler("quitWithoutCheck")});var e={reminders:"setting-sleep-diary","cbti-relaxations":"relaxation-details","sleep-prescriptions":"prescription"},s=this,i=t.data.scheme.replace("sleepdoctor://","").split("?"),n=i[0],a={},r={};switch(n){case"reminders":case"sleep-prescriptions":break;case"cbti-relaxations":r.id=this.getQueryString(i[1],"id")}this.home.callback=function(){s.overFn("href").then(function(){s.$router.push({name:e[n],query:a,params:r})})}},displayQuestions:function(t){var e=this;this.items=[],this.result={},this.result.j1={type:"displayQuestions",data:[]},t.data.map(function(t){var s={title:"你是否有以下的行为习惯？正确请选“✓”，错误请选“✗”",label:t.question,type:"displayQuestions",answer:t.answer?0:1,prop:"j1",message:t.explanation,change:function(t){console.log(t,"judgment callback")}};e.items.push(s)})},pickUpThePost:function(t){var e=this;console.log(t,"勾选后置题");var s=t.data.data;if(this.items=[],this.result={},0===s.length){var i={type:"pickUpThePost",prop:"pickUpThePost"};this.result[i.prop]={type:"pickUpThePost"},this.items.push(i)}s.map(function(t){var s={title:t.selection,type:"pickUpThePost",prop:"pickUpThePost",toast:t.toast,explanation:t.explanation,data:t};e.result[s.prop]={type:"pickUpThePost"},e.items.push(s)})},sleepSituation:function(t){var e=this;console.log(t),t.exercise_is_filled&&(this.resultType="sleepSituation",this.resultData=[],t.data.map(function(t){e.resultData.push(t.user_answer)})),this.items=[],this.result={},this.result.sleepSituation={type:"sleepSituation",data:[]},t.data.forEach(function(t){var s={title:t.question,type:"sleepSituation",prop:"sleepSituation",data:t};e.result[s.prop].data.push(0),e.items.push(s)})},setHome:function(t){console.log(t),this.home.title=t.title,this.home.text=t.description,this.home.doctor=null,this.home.buttonText=t.button},getExercises:function(t){return U.a.get("/cbti-course/"+t+"/exercises").then(function(t){return t.data})}}}),O={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exercises"},[t.resultType?s("cbti-result",{attrs:{resultData:t.resultData,exercises:t.exercises,type:t.resultType},on:{resultSubmit:t.resultSubmit}}):s("sleep-form",{attrs:{items:t.items,home:t.home,result:"result",itemTitle:t.itemTitle,isSelect:t.isSelect,isSubmitBtn:t.isSubmitBtn,SubmitBtnTxt:t.SubmitBtnTxt},on:{overFn:t.overFn}})],1)},staticRenderFns:[]};var E=s("VU/8")(P,O,!1,function(t){s("+w79")},null,null);e.default=E.exports},v8rk:function(t,e){},"x/Fj":function(t,e){}});